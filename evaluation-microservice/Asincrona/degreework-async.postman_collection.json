{
  "info": {
    "_postman_id": "1f6e0e77-6b47-49aa-9d8a-7b5c4c0a9abc",
    "name": "Evaluation Microservice - Async (Evaluations + DegreeWork)",
    "description": "Colecci√≥n para probar evaluation-microservice: crear evaluaciones (con/ sin correcciones), publicar correcciones a la cola, listar por evaluador, y asignar evaluadores a trabajos de grado (v√≠a correos). Basada en los endpoints y DataLoader enviados.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:8083" }
  ],
  "item": [
    {
      "name": "üìÑ Evaluaciones",
      "item": [
        {
          "name": "Crear Evaluaci√≥n - Director (APROBADO, sin correcciones)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"documentId\": 2,\n  \"evaluadorCorreo\": \"carlos.garcia@unicauca.edu.co\",\n  \"resultado\": \"APROBADO\",\n  \"tipo\": \"ANTEPROYECTO\",\n  \"correcciones\": \"Ninguna observaci√≥n. Excelente estructura y redacci√≥n.\"\n}"
            },
            "url": { "raw": "{{baseUrl}}/api/evaluations", "host": ["{{baseUrl}}"], "path": ["api", "evaluations"] },
            "description": "Crea una evaluaci√≥n aprobada por el director (sin correcciones)."
          }
        },
        {
          "name": "Crear Evaluaci√≥n - Codirectora (APROBADO_CON_CORRECCIONES)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"documentId\": 2,\n  \"evaluadorCorreo\": \"laura.torres@unicauca.edu.co\",\n  \"resultado\": \"APROBADO_CON_CORRECCIONES\",\n  \"tipo\": \"ANTEPROYECTO\",\n  \"correcciones\": \"Alinear objetivos espec√≠ficos con metodolog√≠a y ajustar referencias en APA 7.\"\n}"
            },
            "url": { "raw": "{{baseUrl}}/api/evaluations", "host": ["{{baseUrl}}"], "path": ["api", "evaluations"] },
            "description": "Crea una evaluaci√≥n con correcciones por la codirectora."
          }
        },
        {
          "name": "Crear Evaluaci√≥n - Codirector (NO_APROBADO + correcciones)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"documentId\": 1,\n  \"evaluadorCorreo\": \"mateo.rojas@unicauca.edu.co\",\n  \"resultado\": \"NO_APROBADO\",\n  \"tipo\": \"FORMATO_A\",\n  \"correcciones\": \"Redefinir problema, reescribir marco te√≥rico y mejorar dise√±o experimental.\"\n}"
            },
            "url": { "raw": "{{baseUrl}}/api/evaluations", "host": ["{{baseUrl}}"], "path": ["api", "evaluations"] },
            "description": "Evaluaci√≥n no aprobada con correcciones por el codirector."
          }
        },
        {
          "name": "Listar Todas las Evaluaciones",
          "request": {
            "method": "GET",
            "url": { "raw": "{{baseUrl}}/api/evaluations", "host": ["{{baseUrl}}"], "path": ["api", "evaluations"] },
            "description": "Obtiene todas las evaluaciones registradas."
          }
        },
        {
          "name": "Obtener Evaluaciones por Correo - Director",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/evaluations/evaluador/carlos.garcia@unicauca.edu.co",
              "host": ["{{baseUrl}}"],
              "path": ["api", "evaluations", "evaluador", "carlos.garcia@unicauca.edu.co"]
            },
            "description": "Filtra las evaluaciones por correo del evaluador (director)."
          }
        },
        {
          "name": "Eliminar Evaluaci√≥n por ID (ej: 1)",
          "request": {
            "method": "DELETE",
            "url": { "raw": "{{baseUrl}}/api/evaluations/1", "host": ["{{baseUrl}}"], "path": ["api", "evaluations", "1"] },
            "description": "Elimina una evaluaci√≥n por ID."
          }
        },
        {
          "name": "Enviar Correcciones Manualmente (DTO directo a la cola)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"degreeWorkId\": 1,\n  \"estado\": \"ANTEPROYECTO\",\n  \"correcciones\": \"Corregir redacci√≥n de objetivos y actualizar antecedentes.\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/evaluations/correcciones",
              "host": ["{{baseUrl}}"],
              "path": ["api", "evaluations", "correcciones"]
            },
            "description": "Publica manualmente un DegreeWorkUpdateDTO a la cola con estado + correcciones."
          }
        }
      ]
    },
    {
      "name": "üéì DegreeWorks (vista local en evaluation-ms)",
      "item": [
        {
          "name": "Listar TODOS los DegreeWorks",
          "request": {
            "method": "GET",
            "url": { "raw": "{{baseUrl}}/api/degreeworks", "host": ["{{baseUrl}}"], "path": ["api", "degreeworks"] },
            "description": "Lista todos los TG cacheados en evaluation-ms (seg√∫n tu repositorio local)."
          }
        },
        {
          "name": "Listar SOLO Anteproyectos",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/degreeworks/anteproyectos",
              "host": ["{{baseUrl}}"],
              "path": ["api", "degreeworks", "anteproyectos"]
            },
            "description": "Obtiene √∫nicamente los TG en estado ANTEPROYECTO."
          }
        },
        {
          "name": "Obtener TG por correo del estudiante (Dana)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/degreeworks/correo/dana.romero@unicauca.edu.co",
              "host": ["{{baseUrl}}"],
              "path": ["api", "degreeworks", "correo", "dana.romero@unicauca.edu.co"]
            },
            "description": "Busca el TG por correo del estudiante (Dana)."
          }
        },
        {
          "name": "Obtener TG por correo del estudiante (Juan)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/degreeworks/correo/juan.perez@unicauca.edu.co",
              "host": ["{{baseUrl}}"],
              "path": ["api", "degreeworks", "correo", "juan.perez@unicauca.edu.co"]
            },
            "description": "Busca el TG por correo del estudiante (Juan)."
          }
        },
        {
          "name": "Asignar Evaluadores por correo (Laura + Mateo) al TG 1",
          "request": {
            "method": "POST",
            "url": {
              "raw": "{{baseUrl}}/api/degreeworks/1/asignar-evaluadores?correoEvaluador1=laura.torres@unicauca.edu.co&correoEvaluador2=mateo.rojas@unicauca.edu.co",
              "host": ["{{baseUrl}}"],
              "path": ["api", "degreeworks", "1", "asignar-evaluadores"],
              "query": [
                { "key": "correoEvaluador1", "value": "laura.torres@unicauca.edu.co" },
                { "key": "correoEvaluador2", "value": "mateo.rojas@unicauca.edu.co" }
              ]
            },
            "description": "Golpea el endpoint del EvaluationController ‚Üí DegreeWorkService (publica evento a degreework.queue)."
          }
        },
        {
          "name": "Asignar Evaluadores por correo (Carlos + Laura) al TG 1",
          "request": {
            "method": "POST",
            "url": {
              "raw": "{{baseUrl}}/api/degreeworks/1/asignar-evaluadores?correoEvaluador1=carlos.garcia@unicauca.edu.co&correoEvaluador2=laura.torres@unicauca.edu.co",
              "host": ["{{baseUrl}}"],
              "path": ["api", "degreeworks", "1", "asignar-evaluadores"],
              "query": [
                { "key": "correoEvaluador1", "value": "carlos.garcia@unicauca.edu.co" },
                { "key": "correoEvaluador2", "value": "laura.torres@unicauca.edu.co" }
              ]
            },
            "description": "Variante usando al director como evaluador1."
          }
        }
      ]
    }
  ]
}
